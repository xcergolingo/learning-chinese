<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chinese Character Writing Practice</title>
  <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@2.2.2/dist/hanzi-writer.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    #writer { width: 300px; height: 300px; margin: 0 auto; }
    canvas { border: 2px solid #333; background: #fff; margin-top: 10px; cursor: crosshair; }
    button { margin: 10px 5px; padding: 10px 20px; font-size: 16px; }
    #pinyin, #meaning { font-size: 20px; margin: 5px 0; }
  </style>
</head>
<body>

  <h1>Chinese Character Writing Practice</h1>
  <div id="writer"></div>
  <div id="pinyin"></div>
  <div id="meaning"></div>

  <canvas id="canvas" width="300" height="300"></canvas><br>

  <button onclick="playAnimation()">Show Stroke Order</button>
  <button onclick="clearCanvas()">Clear Drawing</button>
  <button onclick="nextCharacter()">Next Character</button>

  <script>
    const characters = [
      { char: '你', pinyin: 'nǐ', meaning: 'you' },
      { char: '好', pinyin: 'hǎo', meaning: 'good' },
      { char: '学', pinyin: 'xué', meaning: 'to study' },
      { char: '习', pinyin: 'xí', meaning: 'to practice' },
      { char: '汉', pinyin: 'hàn', meaning: 'Han (Chinese)' },
      { char: '字', pinyin: 'zì', meaning: 'character' },
      { char: '谢', pinyin: 'xiè', meaning: 'thank' },
      { char: '我', pinyin: 'wǒ', meaning: 'I/​me' },
      { char: '们', pinyin: 'men', meaning: 'plural marker' },
      { char: '是', pinyin: 'shì', meaning: 'to be' }
    ];

    let currentIndex = 0;
    let writer = null;

    function loadCharacter(charData) {
      // 1) Clear previous SVG
      const container = document.getElementById('writer');
      container.innerHTML = '';

      // 2) Create new HanziWriter instance
      writer = HanziWriter.create('writer', charData.char, {
        width: 300,
        height: 300,
        padding: 5,
        showCharacter: false,
        showOutline: true,
        strokeAnimationSpeed: 1,
        delayBetweenStrokes: 100
      });

      // 3) Update pinyin/meaning
      document.getElementById('pinyin').textContent = 'Pinyin: ' + charData.pinyin;
      document.getElementById('meaning').textContent = 'Meaning: ' + charData.meaning;
    }

    function playAnimation() {
      if (writer) writer.animateCharacter();
    }

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
    }

    function nextCharacter() {
      currentIndex = (currentIndex + 1) % characters.length;
      clearCanvas();
      loadCharacter(characters[currentIndex]);
    }

    // --- Canvas drawing setup ---
    const canvas = document.getElementById('canvas');
    const ctx    = canvas.getContext('2d');
    let   drawing = false;

    canvas.addEventListener('mousedown', () => drawing = true);
    canvas.addEventListener('mouseup',   () => { drawing = false; ctx.beginPath(); });
    canvas.addEventListener('mouseout',  () => { drawing = false; ctx.beginPath(); });
    canvas.addEventListener('mousemove', e => {
      if (!drawing) return;
      const r = canvas.getBoundingClientRect();
      ctx.lineWidth = 3;
      ctx.lineCap   = 'round';
      ctx.strokeStyle = '#000';
      ctx.lineTo(e.clientX - r.left, e.clientY - r.top);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(e.clientX - r.left, e.clientY - r.top);
    });

    canvas.addEventListener('touchstart', e => {
      e.preventDefault();
      drawing = true;
      const t = e.touches[0], r = canvas.getBoundingClientRect();
      ctx.beginPath();
      ctx.moveTo(t.clientX - r.left, t.clientY - r.top);
    });
    canvas.addEventListener('touchmove', e => {
      e.preventDefault();
      if (!drawing) return;
      const t = e.touches[0], r = canvas.getBoundingClientRect();
      ctx.lineTo(t.clientX - r.left, t.clientY - r.top);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(t.clientX - r.left, t.clientY - r.top);
    });
    canvas.addEventListener('touchend', () => { drawing = false; ctx.beginPath(); });

    // Initialize
    loadCharacter(characters[currentIndex]);
  </script>

</body>
</html>
